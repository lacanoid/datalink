-- test curl
select body,size,content_type from datalink.curl_perform(null,'data:,Hello%2C%20World%21');
     body      | size |        content_type         
---------------+------+-----------------------------
 Hello, World! |   13 | text/plain;charset=US-ASCII
(1 row)

select body,size,content_type from datalink.curl_perform(null,'data:text/plain;base64,SGVsbG8sIFdvcmxkIQ==');
         body         | size |   content_type    
----------------------+------+-------------------
 SGVsbG8sIFdvcmxkIQ== |   20 | text/plain;base64
(1 row)

select body,size,content_type from datalink.curl_perform(null,'data:text/html,%3Ch1%3EHello%2C%20World%21%3C%2Fh1%3E');
          body          | size | content_type 
------------------------+------+--------------
 <h1>Hello, World!</h1> |   22 | text/html
(1 row)

select body,size,content_type from datalink.curl_perform(null,'data:text/html,%3Cscript%3Ealert%28%27hi%27%29%3B%3C%2Fscript%3E');
             body              | size | content_type 
-------------------------------+------+--------------
 <script>alert('hi');</script> |   29 | text/html
(1 row)

create server zala foreign data wrapper postgres_fdw options (dbname 'contrib_regression');
create user mapping for current_user server zala;
select url,ok,rc,error from datalink.curl_get('file://zala/etc/issue');
          url          | ok | rc | error 
-----------------------+----+----+-------
 file://zala/etc/issue | t  |  0 | 
(1 row)

select url,ok,rc,error from datalink.curl_perform(null,'file://zala/etc/issue');
          url          | ok | rc | error 
-----------------------+----+----+-------
 file://zala/etc/issue | t  |  0 | 
(1 row)

drop user mapping for current_user server zala;
drop server zala;
